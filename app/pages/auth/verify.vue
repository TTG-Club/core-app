<script setup lang="ts">
  import { StatusCodes } from 'http-status-codes';

  import { PageContainer } from '~ui/page';

  const {
    query: { token },
  } = useRoute();

  if (!token) {
    throw createError(getErrorResponse(StatusCodes.BAD_REQUEST));
  }

  await useFetch('/api/auth/confirm/email', {
    method: 'PUT',
    params: { token },
    onResponseError: () => {
      throw createError(getErrorResponse(StatusCodes.BAD_REQUEST));
    },
    onRequestError: () => {
      throw createError(getErrorResponse(StatusCodes.BAD_REQUEST));
    },
  });
</script>

<template>
  <PageContainer>
    <AFlex
      :style="{ flex: 1 }"
      :gap="8"
      justify="center"
      vertical
    >
      <ATypographyTitle
        :level="1"
        data-allow-mismatch
      >
        –í–∞—à —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ ü•≥
      </ATypographyTitle>

      <ATypographyText
        type="secondary"
        data-allow-mismatch
      >
        –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥
      </ATypographyText>

      <AFlex :gap="12">
        <AButton
          type="primary"
          href="/"
          @click.left.exact.prevent="navigateTo({ name: 'index' })"
        >
          –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
        </AButton>
      </AFlex>
    </AFlex>
  </PageContainer>
</template>
