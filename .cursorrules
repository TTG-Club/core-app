# Project Rules & Guidelines

## 1. Core Workflow (Must Follow)
- **Analyze First:** Before writing any code, ALWAYS analyze the existing project codebase. Look at similar logic, file structure, and coding styles. Strictly follow established patterns and conventions to ensure consistency.
- **Single Dictionary:** The code must read fluently without surprises, adhering to a unified project dictionary.
- **Code Style:** Strictly follow the project's ESLint, Prettier, and Stylelint configurations.

## 2. Type Safety (Strict TypeScript)
- **Strict Typing:** Strong typing is mandatory.
- **No any:** The use of `any` is strictly prohibited.
- **No Assertions:** Do not use type assertions (`as Type`) or forced casting.
- **No Magic Numbers:** Avoid hardcoded numbers or type assertions in variables/fields.

## 3. Naming Conventions
- **Language:** Use full English names only for variables, functions, and classes.
- **Clarity over Brevity:** No abbreviations (e.g., `lst`, `ua`), no abstract names (`data`, `item`), and no single-letter names (except in mini-loops).
- **Structure:**
  - One function = one task. One verb per action.
  - Different roots for different meanings (no similar terms like `date`/`data`).
  - No underscores. No prefixes like `super*`, `mega*`.
- **Feature Component Naming:**
  - Components inside features must reflect their path: `[FeatureName][Subfolder][Name].vue`.
  - *Exception:* Components in `*/ui` subfolder should be named by their function (atomic components) without heavy prefixes.
- **Constants:**
  - Use `const` variables with Uppercase/CamelCase naming conventions.
  - **PROHIBITED:** Do not create functions that simply return a static constant value.
- **Booleans:** Functions starting with `is*` or `check*` must return a boolean and have NO side effects.

## 4. Styling & Design System
- **Semantic Colors Only:**
  - **PROHIBITED:** Do not use color scheme modifiers directly in classes (`dark:`, `light:`).
  - **REQUIRED:** Use unified semantic color names (`bg-surface`, `text-primary`) mapped to CSS variables.
- **No Arbitrary Variables:**
  - **PROHIBITED:** `bg-[var(--ui-bg-elevated)]`.
  - **REQUIRED:** Use standard utility classes (e.g., `bg-ui-elevated`).
- **Icons:** Use ONLY icons from the local `ttg` collection or `fluent` collection.
- **Tailwind CSS:** Use Tailwind CSS according to the maximum version specified in the project.

## 5. Project Architecture & Reuse Strategy
- **Folder Structure Context:**
  - `shared/ui`: **Global UI Kit.**
  - `app/features`: **DOMAIN LOGIC CENTER.**
    - `*/body`, `*/drawer`, `*/editor`: View components.
    - `*/model`: Feature-specific logic and constants.
    - `*/ui`: Feature-specific reusable UI.
  - `server/domain` & `server/api`: **BACKEND LAYER.**
  - `app/components`: **DOES NOT EXIST.**

- **Import Strategy (Aliases):**
  - **ALWAYS** use feature aliases for imports, even inside the feature itself.
  - *Example:* Inside `app/features/dice-roller`, import via `~dice-roller/model`, NOT `../../model` or `./model`.
  - Run `pnpm run postinstall` if a new feature alias is missing.

- **Barrel Files (index.ts):**
  - **Feature Root:** NO `index.ts` allowed in the root of a feature folder (e.g., `app/features/bestiary/index.ts` -> ‚ùå).
  - **Subfolders:** YES, `index.ts` is REQUIRED in subfolders (`model`, `ui`, `body`) for clean re-exports.

- **Reuse Rule (Priority Order):**
  - **UI:** 1. **Nuxt UI** (@nuxt/ui). 2. `shared/ui`. 3. `app/features/*/ui`.
  - **Logic:** Check `shared/` for global utilities/stores. Check `app/features/*/model` for domain logic.

## 6. Tech Stack & Best Practices
- **Official Documentation Context:**
  - **MANDATORY:** For any Nuxt-related architecture or implementation questions, ALWAYS refer to the official guidelines for LLMs:
    - `https://nuxt.com/llms-full.txt` (Complete Guidelines)
- **Framework Core:** Use **Nuxt 4** and **Vue 3.5** best practices (Composition API, `<script setup>`).
- **Rendering:**
  - Purely frontend features (like Dice Rollers) MUST be wrapped in `<ClientOnly>`. Do not render them on SSR.
- **Event Handling:**
  - **Default Click Strategy:** Use `@click.left.exact.prevent` by default for interactive elements to avoid unwanted side effects, unless specific behavior is required.
- **State Management:**
  - Avoid `provide/inject`. Use Composables or Pinia stores for state sharing.
- **Documentation (JSDoc):**
  - All utility functions (especially in `utils.ts`) MUST have **JSDoc in Russian** explaining parameters, return values, and purpose.
  - **NO HTML:** Do NOT use HTML tags (like `<ul>`, `<li>`, `<br>`) in JSDoc. Use standard Markdown syntax (e.g., `-` for lists) for formatting.
  - *Note:* Code identifiers (variables, functions) remain in English.
- **Composables & Utils:**
  - Avoid overhead.
  - Use specific project composables: `useDayjs` for time.
  - Use `vueuse` wrappers (e.g., `useIDBKeyval`) instead of raw browser APIs where applicable.

## 7. AI & MCP Tools Integration
- **Nuxt UI MCP Server:**
  - **ACTIVE USAGE REQUIRED:** When implementing or modifying UI components, you MUST explicitly query the connected Nuxt UI MCP server (using tools like `search_components`, `get_component`) to retrieve the exact prop definitions, slots, and usage examples.
  - **NO GUESSING:** Do not hallucinate component props. Always verify against the MCP source of truth.
  - *Reference:* https://ui.nuxt.com/docs/getting-started/ai/mcp